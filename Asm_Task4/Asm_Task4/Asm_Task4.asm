.include "m16def.inc"
.DSEG
.CSEG
.ORG 0
JMP RESET
.ORG $010
JMP TIM1_OVF

RESET:
	LDI R16,HIGH(RAMEND)
	OUT SPH,R16
	LDI R16,LOW(RAMEND)
	OUT SPL,R16
	LDI R16,0b11111111
	OUT DDRD,R16
	OUT DDRC,R16
	OUT DDRB,R16
	OUT DDRA,R16
	LDI R16,0b00000101
	OUT TCCR1B,R16
	LDI R16,0b00000100
	OUT TIMSK,R16
	OUT TIFR,R16
	LDI R16,0xF0
	OUT TCNT1H,R16
	OUT TCNT1L,R16
	LDI R17,0b00000001
	SEI
MAIN:
	RJMP MAIN
TIM1_OVF:
	CLI
	CPI R17,0b00000001
	BREQ LED2
	CPI R17,0b00000010
	BREQ LED3
	CPI R17,0b00000100
	BREQ LED4
	CPI R17,0b00001000
	BREQ LED5
	RCALL BUF
VIX:
	LDI R16,0xEE
	OUT TCNT1H,R16
	OUT TCNT1L,R16
	LDI R16,0b11111111
	SEI
	RETI
LED1:
	LDI R17,0b00000001
	LDI R18,0b01000000
	OUT PORTA,R18 
	LDI R18,0b10110000
	OUT PORTB,R18
	LDI R18,0b10110000
	OUT PORTC,R18
	LDI R18,0b01000000
	OUT PORTD,R18
	RJMP VIX
LED2:
	LDI R17,0b00000010
	LDI R18,0b00100000
	OUT PORTA,R18 
	LDI R18,0b01011000
	OUT PORTB,R18
	LDI R18,0b01011000
	OUT PORTC,R18
	LDI R18,0b00100000
	OUT PORTD,R18	
	RJMP VIX
LED3:
	LDI R17,0b00000100
	LDI R18,0b00010000
	OUT PORTA,R18 
	LDI R18,0b00101100
	OUT PORTB,R18
	LDI R18,0b00101100
	OUT PORTC,R18
	LDI R18,0b00010000
	OUT PORTD,R18
	RJMP VIX
LED4:
	LDI R17,0b00001000
	LDI R18,0b00001000
	OUT PORTA,R18 
	LDI R18,0b00010110
	OUT PORTB,R18
	LDI R18,0b00010110
	OUT PORTC,R18
	LDI R18,0b00001000
	OUT PORTD,R18
	RJMP VIX
LED5:
	LDI R17,0b00010000
	LDI R18,0b00000100
	OUT PORTA,R18 
	LDI R18,0b00001011
	OUT PORTB,R18
	LDI R18,0b00001011
	OUT PORTC,R18
	LDI R18,0b00000100
	OUT PORTD,R18
	RJMP VIX
BUF:
	CPI R17,0b00010000
	BREQ LED6
	CPI R17,0b00100000
	BREQ LED7
	CPI R17,0b01000000
	BREQ LED8
	CPI R17,0b10000000
	BREQ LED1
	RJMP VIX
LED6:
	LDI R17,0b00100000
	LDI R18,0b00001000
	OUT PORTA,R18 
	LDI R18,0b00010110
	OUT PORTB,R18
	LDI R18,0b00010110
	OUT PORTC,R18
	LDI R18,0b00001000
	OUT PORTD,R18
	RJMP VIX
LED7:
	LDI R17,0b01000000
	LDI R18,0b00010000
	OUT PORTA,R18 
	LDI R18,0b00101100
	OUT PORTB,R18
	LDI R18,0b00101100
	OUT PORTC,R18
	LDI R18,0b00010000
	OUT PORTD,R18
	RJMP VIX
LED8:
	LDI R17,0b10000000
	LDI R18,0b00100000
	OUT PORTA,R18 
	LDI R18,0b01011000
	OUT PORTB,R18
	LDI R18,0b01011000
	OUT PORTC,R18
	LDI R18,0b00100000
	OUT PORTD,R18	
	RJMP VIX
